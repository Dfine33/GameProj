# 整体思路
- 删去冗余，保留对“框架/关键文件/关键接口/关键功能”的精炼总结
- 在 README 末尾新增“文件索引（逐文件说明）”章节，覆盖项目中所有 Python 文件的职责与入口关系
- 不变更代码，仅更新 README（一次提交完成）

# README 目标结构
## 1. 项目总览（精炼版）
- 架构：MVC（Model/Controller/View）+ SimulationLoop（引擎）+ AI 策略层
- 模式：EVE（电脑对战）、PVE（人机对战）、调试工具、地图编辑器
- 地图/单位/状态：六边形栅格（odd-r）、基地/单位属性、序列化
- 回合流程：操作阶段→结算阶段（生成→攻击→移动）→下一回合；冲突仲裁与批量伤害

## 2. 关键文件与接口
- Model：`core/state.py`（状态/序列化）、`core/map.py`（地形）、`core/entities.py`（Base/Unit）
- Engine：`simulation/loop.py`（回合引擎、阶段/仲裁、预览路径）、关键方法：`step()`、`resolve_attacks()`、`resolve_movements()`、`preview_path()`
- AI：`ai/policy.py`（Action/TwoPhase/ Simple）、`ai/unit_policies.py`（Scout/Infantry/Archer/Composite）、`ai/spawn_strategy.py`（随机生成）
- Controller：`controllers/game_controller.py`（菜单/模式/输入、PVE 操作与预览数据绑定）
- View：`renderer/pygame_renderer.py`（渲染/HUD/叠加预览/LO S）、`views/pygame_view.py`（菜单按钮与面板 UI）
- Utils：`utils/common.py`（hex_neighbors/hex_distance/hex_line 等）
- Entrypoint：`rts_pygame.py`（创建 Renderer/View/Controller 并运行）
- Editor/Tools：`map_editor.py`（地图编辑器）、`tools/vision_path_tester.py`（视野/路径调试器）
- Web：`web/server.py`、`web/app.js`（Canvas 预览）
- Balance：`core/balance.py`（点数与兵种属性/成本）

## 3. 关键功能（行为级）
- 视野：六边形 LOS（山阻挡、河不阻挡）；渲染与引擎对齐
- 生成：点数制、不累计；玩家队列与 AI 随机生成
- 攻击：批量伤害统一结算（支持互相击杀）
- 移动：基于“已知可走”（可见或已探索）的 BFS 路径；两阶段同格仲裁；基地视作障碍
- 预览：招募幽灵单位、移动路径/目标幽灵单位、攻击箭头；结束后自动清除
- 菜单/模式：EVE 连续/逐步；PVE 阵营选择、逐帧操作、结束按钮

## 4. 模式总结（EVE / PVE）
- EVE：AI 双方、随机或自选地图、结束界面重开/回主菜单
- PVE：阵营选择/视野锁定、操作→结算→回合推进、基地/单位面板（招募/移动/攻击/撤回）、约束（未知不可达/基地障碍）

## 5. 电脑策略总览
- CompositePolicy：按兵种分派；Scout/Infantry/Archer 行为
- TwoPhasePolicy：侦察→总攻，记录基地并推进
- SimplePolicy：最近目标优先
- 生成策略：RandomSpawnStrategy 点数填充
- 流程：生成→攻击（批量）→移动（仲裁）

## 6. 文件索引（逐文件说明）
- 顶层：
  - `rts_pygame.py`：应用入口，创建 `PygameRenderer`/`PygameView`/`GameController` 并运行
- core/
  - `core/map.py`：地形常量与地图类（宽高与网格），随机生成与可走判断
  - `core/entities.py`：`Base`（含每回合点数/增益）与 `Unit` 属性模型
  - `core/state.py`：全局状态、单位列表/占用集、序列化/反序列化、探索与基地记录
  - `core/balance.py`：造兵点数与兵种属性/成本配置
- simulation/
  - `simulation/loop.py`：回合引擎；阶段（操作/结算）、预览路径、攻击批量伤害、移动仲裁与同格竞争
- ai/
  - `ai/policy.py`：`Action` 类型；`DecisionPolicy` 抽象；`SimplePolicy` 与 `TwoPhasePolicy`
  - `ai/unit_policies.py`：分兵种策略（Scout/Infantry/Archer）与 `CompositePolicy`
  - `ai/spawn_strategy.py`：`ISpawnStrategy` 与 `RandomSpawnStrategy`
- renderer/
  - `renderer/base.py`：渲染接口定义
  - `renderer/pygame_renderer.py`：六边形绘制、HUD/控件、预览叠加、LOS 计算
  - `renderer/char.py`：终端字符渲染（用于非图形环境）
- controllers/
  - `controllers/game_controller.py`：菜单/模式/输入事件；PVE 面板交互（招募/移动/攻击/撤回）；预览数据注入
- views/
  - `views/pygame_view.py`：主菜单/二级菜单与结算界面按钮、悬浮/选中态视觉反馈
- utils/
  - `utils/common.py`：六边形工具集（邻居/距离/线段/坐标转换）
- tools/
  - `tools/vision_path_tester.py`：独立调试器，放置障碍/单位/目标，检查 LOS 与 BFS 路径并可保存场景
- web/
  - `web/server.py`：HTTP 服务（状态与控制接口）
  - `web/app.js`：Canvas 端六边形渲染与简单 UI
- 其他：
  - `map_editor.py`：地图编辑器（地形/镜像放置、命名保存、基地摆放）

## 7. 冗余清理
- 合并原 README 的“设计要点/模式/电脑策略/平衡配置/运行方式/关键接口”章节，去掉重复的接口解释；保留关键位置引用（`file:line`）
- 本版 README 作为阶段性快照，后续演进只需补充“变更记录”节

# 交付
- 我将一次性替换 README 相关章节（不修改代码），按上述结构落地：
  - 精炼总览；关键文件与接口；关键功能；模式总结；电脑策略总览；文件索引；冗余清理说明
- 输出格式保持当前 README 风格（段落 + 精简条目 + 关键位置引用）

请确认后我将直接更新 README。